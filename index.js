const _0x4f4c1a=_0x45e2;(function(_0x29b04e,_0x1a4ecd){const _0x5cc9d6=_0x45e2,_0x15d0d4=_0x29b04e();while(!![]){try{const _0xf5583a=parseInt(_0x5cc9d6(0x9e))/0x1*(-parseInt(_0x5cc9d6(0xc2))/0x2)+-parseInt(_0x5cc9d6(0xca))/0x3*(-parseInt(_0x5cc9d6(0x7d))/0x4)+parseInt(_0x5cc9d6(0x97))/0x5*(parseInt(_0x5cc9d6(0xbf))/0x6)+-parseInt(_0x5cc9d6(0xb6))/0x7*(-parseInt(_0x5cc9d6(0x80))/0x8)+-parseInt(_0x5cc9d6(0xa2))/0x9+-parseInt(_0x5cc9d6(0x99))/0xa*(-parseInt(_0x5cc9d6(0xb7))/0xb)+parseInt(_0x5cc9d6(0x8d))/0xc*(-parseInt(_0x5cc9d6(0x9c))/0xd);if(_0xf5583a===_0x1a4ecd)break;else _0x15d0d4['push'](_0x15d0d4['shift']());}catch(_0x45adab){_0x15d0d4['push'](_0x15d0d4['shift']());}}}(_0x574b,0x87c9e));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x4f4c1a(0xd1)),net=require('net'),path=require(_0x4f4c1a(0x88)),crypto=require(_0x4f4c1a(0xad)),{Buffer}=require('buffer'),{exec,execSync}=require(_0x4f4c1a(0xd9)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env']['UUID']||_0x4f4c1a(0xde),NEZHA_SERVER=process[_0x4f4c1a(0xe7)][_0x4f4c1a(0x94)]||'',NEZHA_PORT=process[_0x4f4c1a(0xe7)][_0x4f4c1a(0xd2)]||'',NEZHA_KEY=process[_0x4f4c1a(0xe7)][_0x4f4c1a(0xe5)]||'',DOMAIN=process[_0x4f4c1a(0xe7)][_0x4f4c1a(0xd0)]||_0x4f4c1a(0xbe),AUTO_ACCESS=process[_0x4f4c1a(0xe7)]['AUTO_ACCESS']||!![],WSPATH=process['env']['WSPATH']||UUID[_0x4f4c1a(0x83)](0x0,0x8),SUB_PATH=process['env'][_0x4f4c1a(0xa6)]||_0x4f4c1a(0xc8),NAME=process['env'][_0x4f4c1a(0xc9)]||'',PORT=process[_0x4f4c1a(0xe7)]['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x4b6c12=_0x4f4c1a;try{const _0xf3f9b=await axios[_0x4b6c12(0xe6)](_0x4b6c12(0x8f)),_0x253337=_0xf3f9b[_0x4b6c12(0x9b)];ISP=(_0x253337['country_code']+'-'+_0x253337[_0x4b6c12(0xa7)])['replace'](/ /g,'_');}catch(_0x5bbe39){ISP=_0x4b6c12(0xc1);}};GetISP();const httpServer=http[_0x4f4c1a(0xdd)]((_0x21730d,_0x2978b5)=>{const _0x3bb206=_0x4f4c1a;if(_0x21730d[_0x3bb206(0xe8)]==='/'){const _0x589711=path[_0x3bb206(0xea)](__dirname,_0x3bb206(0xa8));fs[_0x3bb206(0x72)](_0x589711,_0x3bb206(0x77),(_0x48f28d,_0x22c503)=>{const _0x26de9f=_0x3bb206;if(_0x48f28d){_0x2978b5[_0x26de9f(0xe3)](0xc8,{'Content-Type':_0x26de9f(0xd3)}),_0x2978b5[_0x26de9f(0xe4)](_0x26de9f(0xd7));return;}_0x2978b5[_0x26de9f(0xe3)](0xc8,{'Content-Type':'text/html'}),_0x2978b5[_0x26de9f(0xe4)](_0x22c503);});return;}else{if(_0x21730d[_0x3bb206(0xe8)]==='/'+SUB_PATH){const _0x1b6d68=NAME?NAME+'-'+ISP:ISP,_0x5b86f7=_0x3bb206(0x86)+UUID+'@'+DOMAIN+_0x3bb206(0xcc)+DOMAIN+_0x3bb206(0x7f)+DOMAIN+_0x3bb206(0x7e)+WSPATH+'#'+_0x1b6d68,_0xba8b04=_0x3bb206(0x8c)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x3bb206(0x7f)+DOMAIN+_0x3bb206(0x7e)+WSPATH+'#'+_0x1b6d68,_0x34dc37=_0x5b86f7+'\x0a'+_0xba8b04,_0x5367d2=Buffer['from'](_0x34dc37)[_0x3bb206(0xc7)](_0x3bb206(0xcf));_0x2978b5['writeHead'](0xc8,{'Content-Type':_0x3bb206(0xb0)}),_0x2978b5[_0x3bb206(0xe4)](_0x5367d2+'\x0a');}else _0x2978b5['writeHead'](0x194,{'Content-Type':'text/plain'}),_0x2978b5[_0x3bb206(0xe4)](_0x3bb206(0x7b));}}),wss=new WebSocket[(_0x4f4c1a(0xb5))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x4f4c1a(0x91),_0x4f4c1a(0xbd)];function resolveHost(_0x415fff){return new Promise((_0x51030a,_0x556b03)=>{const _0x3d68e2=_0x45e2;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x3d68e2(0x8a)](_0x415fff)){_0x51030a(_0x415fff);return;}let _0x4f33dd=0x0;function _0x3dea89(){const _0x52d6e9=_0x3d68e2;if(_0x4f33dd>=DNS_SERVERS[_0x52d6e9(0xb1)]){_0x556b03(new Error(_0x52d6e9(0xb2)+_0x415fff+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x4b0821=DNS_SERVERS[_0x4f33dd];_0x4f33dd++;const _0x35c1d7='https://dns.google/resolve?name='+encodeURIComponent(_0x415fff)+_0x52d6e9(0xac);axios[_0x52d6e9(0xe6)](_0x35c1d7,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x52d6e9(0x7a)](_0x4ed9fd=>{const _0x219468=_0x52d6e9,_0x26b64c=_0x4ed9fd['data'];if(_0x26b64c['Status']===0x0&&_0x26b64c[_0x219468(0xd5)]&&_0x26b64c[_0x219468(0xd5)][_0x219468(0xb1)]>0x0){const _0x2d18ed=_0x26b64c[_0x219468(0xd5)][_0x219468(0x98)](_0x535405=>_0x535405[_0x219468(0x82)]===0x1);if(_0x2d18ed){_0x51030a(_0x2d18ed[_0x219468(0x9b)]);return;}}_0x3dea89();})['catch'](_0x32a179=>{_0x3dea89();});}_0x3dea89();});}function handleVlessConnection(_0x321fb3,_0x1211f4){const _0x55b0e9=_0x4f4c1a,[_0x2207de]=_0x1211f4,_0x135848=_0x1211f4[_0x55b0e9(0x83)](0x1,0x11);if(!_0x135848[_0x55b0e9(0xc0)]((_0x15bfd0,_0x5c255d)=>_0x15bfd0==parseInt(uuid[_0x55b0e9(0xa5)](_0x5c255d*0x2,0x2),0x10)))return![];let _0x442f8d=_0x1211f4[_0x55b0e9(0x83)](0x11,0x12)[_0x55b0e9(0xcd)]()+0x13;const _0x54a614=_0x1211f4['slice'](_0x442f8d,_0x442f8d+=0x2)['readUInt16BE'](0x0),_0x327118=_0x1211f4[_0x55b0e9(0x83)](_0x442f8d,_0x442f8d+=0x1)[_0x55b0e9(0xcd)](),_0x4f2635=_0x327118==0x1?_0x1211f4[_0x55b0e9(0x83)](_0x442f8d,_0x442f8d+=0x4)['join']('.'):_0x327118==0x2?new TextDecoder()[_0x55b0e9(0x7c)](_0x1211f4['slice'](_0x442f8d+0x1,_0x442f8d+=0x1+_0x1211f4['slice'](_0x442f8d,_0x442f8d+0x1)[_0x55b0e9(0xcd)]())):_0x327118==0x3?_0x1211f4[_0x55b0e9(0x83)](_0x442f8d,_0x442f8d+=0x10)[_0x55b0e9(0xaa)]((_0x56e22,_0x47cae1,_0x2acbd2,_0x16cd31)=>_0x2acbd2%0x2?_0x56e22[_0x55b0e9(0x87)](_0x16cd31[_0x55b0e9(0x83)](_0x2acbd2-0x1,_0x2acbd2+0x1)):_0x56e22,[])[_0x55b0e9(0x6f)](_0x872a76=>_0x872a76[_0x55b0e9(0xe9)](0x0)[_0x55b0e9(0xc7)](0x10))[_0x55b0e9(0xea)](':'):'';_0x321fb3[_0x55b0e9(0xb9)](new Uint8Array([_0x2207de,0x0]));const _0x5d701e=createWebSocketStream(_0x321fb3);return resolveHost(_0x4f2635)[_0x55b0e9(0x7a)](_0x5724c7=>{const _0x559f2d=_0x55b0e9;net[_0x559f2d(0xba)]({'host':_0x5724c7,'port':_0x54a614},function(){const _0x3d21e2=_0x559f2d;this[_0x3d21e2(0xd6)](_0x1211f4['slice'](_0x442f8d)),_0x5d701e['on'](_0x3d21e2(0xc6),()=>{})[_0x3d21e2(0xb4)](this)['on']('error',()=>{})[_0x3d21e2(0xb4)](_0x5d701e);})['on'](_0x559f2d(0xc6),()=>{});})[_0x55b0e9(0x85)](_0x344e81=>{const _0x57653b=_0x55b0e9;net['connect']({'host':_0x4f2635,'port':_0x54a614},function(){const _0x288375=_0x45e2;this[_0x288375(0xd6)](_0x1211f4['slice'](_0x442f8d)),_0x5d701e['on']('error',()=>{})[_0x288375(0xb4)](this)['on'](_0x288375(0xc6),()=>{})[_0x288375(0xb4)](_0x5d701e);})['on'](_0x57653b(0xc6),()=>{});}),!![];}function handleTrojanConnection(_0x1be0c0,_0x19a7e0){const _0x371cda=_0x4f4c1a;try{if(_0x19a7e0[_0x371cda(0xb1)]<0x3a)return![];const _0x5e8dc2=_0x19a7e0[_0x371cda(0x83)](0x0,0x38)[_0x371cda(0xc7)](),_0x59f577=[UUID];let _0x3cf331=null;for(const _0x48bda1 of _0x59f577){const _0x2b723c=crypto['createHash'](_0x371cda(0x90))[_0x371cda(0xdb)](_0x48bda1)['digest'](_0x371cda(0xdc));if(_0x2b723c===_0x5e8dc2){_0x3cf331=_0x48bda1;break;}}if(!_0x3cf331)return![];let _0x6ebbbb=0x38;_0x19a7e0[_0x6ebbbb]===0xd&&_0x19a7e0[_0x6ebbbb+0x1]===0xa&&(_0x6ebbbb+=0x2);const _0x8cb38a=_0x19a7e0[_0x6ebbbb];if(_0x8cb38a!==0x1)return![];_0x6ebbbb+=0x1;const _0x5d50dd=_0x19a7e0[_0x6ebbbb];_0x6ebbbb+=0x1;let _0x1a4c0c,_0x2f86ce;if(_0x5d50dd===0x1)_0x1a4c0c=_0x19a7e0[_0x371cda(0x83)](_0x6ebbbb,_0x6ebbbb+0x4)['join']('.'),_0x6ebbbb+=0x4;else{if(_0x5d50dd===0x3){const _0x4409ca=_0x19a7e0[_0x6ebbbb];_0x6ebbbb+=0x1,_0x1a4c0c=_0x19a7e0[_0x371cda(0x83)](_0x6ebbbb,_0x6ebbbb+_0x4409ca)[_0x371cda(0xc7)](),_0x6ebbbb+=_0x4409ca;}else{if(_0x5d50dd===0x4)_0x1a4c0c=_0x19a7e0[_0x371cda(0x83)](_0x6ebbbb,_0x6ebbbb+0x10)[_0x371cda(0xaa)]((_0x5e499c,_0x4f5413,_0x379952,_0x43c1e9)=>_0x379952%0x2?_0x5e499c[_0x371cda(0x87)](_0x43c1e9['slice'](_0x379952-0x1,_0x379952+0x1)):_0x5e499c,[])[_0x371cda(0x6f)](_0x314df7=>_0x314df7[_0x371cda(0xe9)](0x0)[_0x371cda(0xc7)](0x10))[_0x371cda(0xea)](':'),_0x6ebbbb+=0x10;else return![];}}_0x2f86ce=_0x19a7e0['readUInt16BE'](_0x6ebbbb),_0x6ebbbb+=0x2;_0x6ebbbb<_0x19a7e0[_0x371cda(0xb1)]&&_0x19a7e0[_0x6ebbbb]===0xd&&_0x19a7e0[_0x6ebbbb+0x1]===0xa&&(_0x6ebbbb+=0x2);const _0xd12996=createWebSocketStream(_0x1be0c0);return resolveHost(_0x1a4c0c)[_0x371cda(0x7a)](_0x39f0b5=>{const _0x1daccb=_0x371cda;net[_0x1daccb(0xba)]({'host':_0x39f0b5,'port':_0x2f86ce},function(){const _0x1e4bb1=_0x1daccb;_0x6ebbbb<_0x19a7e0[_0x1e4bb1(0xb1)]&&this[_0x1e4bb1(0xd6)](_0x19a7e0['slice'](_0x6ebbbb)),_0xd12996['on'](_0x1e4bb1(0xc6),()=>{})[_0x1e4bb1(0xb4)](this)['on'](_0x1e4bb1(0xc6),()=>{})[_0x1e4bb1(0xb4)](_0xd12996);})['on'](_0x1daccb(0xc6),()=>{});})[_0x371cda(0x85)](_0x11c048=>{const _0x583b28=_0x371cda;net[_0x583b28(0xba)]({'host':_0x1a4c0c,'port':_0x2f86ce},function(){const _0x5a3b7c=_0x583b28;_0x6ebbbb<_0x19a7e0['length']&&this[_0x5a3b7c(0xd6)](_0x19a7e0[_0x5a3b7c(0x83)](_0x6ebbbb)),_0xd12996['on'](_0x5a3b7c(0xc6),()=>{})[_0x5a3b7c(0xb4)](this)['on'](_0x5a3b7c(0xc6),()=>{})[_0x5a3b7c(0xb4)](_0xd12996);})['on'](_0x583b28(0xc6),()=>{});}),!![];}catch(_0x5e7515){return![];}}wss['on'](_0x4f4c1a(0xb8),(_0x4dc644,_0x29271a)=>{const _0x3cbb6b=_0x4f4c1a,_0x460b73=_0x29271a[_0x3cbb6b(0xe8)]||'';_0x4dc644[_0x3cbb6b(0x92)](_0x3cbb6b(0x89),_0x5d1da9=>{const _0x4eb9e1=_0x3cbb6b;if(_0x5d1da9[_0x4eb9e1(0xb1)]>0x11&&_0x5d1da9[0x0]===0x0){const _0x1fadd1=_0x5d1da9[_0x4eb9e1(0x83)](0x1,0x11),_0x37203d=_0x1fadd1[_0x4eb9e1(0xc0)]((_0x2af232,_0x40b3b3)=>_0x2af232==parseInt(uuid[_0x4eb9e1(0xa5)](_0x40b3b3*0x2,0x2),0x10));if(_0x37203d){!handleVlessConnection(_0x4dc644,_0x5d1da9)&&_0x4dc644[_0x4eb9e1(0xbc)]();return;}}!handleTrojanConnection(_0x4dc644,_0x5d1da9)&&_0x4dc644[_0x4eb9e1(0xbc)]();})['on'](_0x3cbb6b(0xc6),()=>{});});function _0x574b(){const _0x5448aa=['update','hex','createServer','ae3c6750-08d5-4ed3-8c7c-7a75c3a22a0d','npm\x20download\x20successfully','finish','https://','split','writeHead','end','NEZHA_KEY','get','env','url','readUInt16BE','join','arm64','https://arm64.ssss.nyc.mn/agent','map','2096','https://amd64.ssss.nyc.mn/agent','readFile','aarch64','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','2053','utf8','utf-8','config.yaml','then','Not\x20Found\x0a','decode','4zDuDFF','&path=%2F','&fp=chrome&type=ws&host=','40KrMPLK','npm\x20is\x20already\x20running,\x20skip\x20running...','type','slice','trim','catch','vless://','concat','path','message','test','npm\x20running\x20error:','trojan://','72DiIbRK','2083','https://api.ip.sb/geoip','sha224','8.8.4.4','once','npm\x20is\x20running','NEZHA_SERVER','Automatic\x20Access\x20Task\x20added\x20successfully','error:\x20','15HmtHvx','find','2566220CBdKaw','arch','data','2972918vgpZea','npm','84efFdkt','includes','https://amd64.ssss.nyc.mn/v1','writeFileSync','4578939cTXpkB','https://arm64.ssss.nyc.mn/v1','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','substr','SUB_PATH','isp','index.html','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','reduce','\x20-p\x20','&type=A','crypto','createWriteStream','listen','text/plain','length','Failed\x20to\x20resolve\x20','443','pipe','Server','906731MDDvHo','44fBScgn','connection','send','connect','false','close','1.1.1.1','1234.abc.com','693060zEqpTo','every','Unknown','2762weszHb','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','client_secret:\x20','chmod\x20+x\x20npm','error','toString','sub','NAME','1597194iFQWCr','--tls',':443?encryption=none&security=tls&sni=','readUInt8','https://oooo.serv00.net/add-url','base64','DOMAIN','axios','NEZHA_PORT','text/html','log','Answer','write','Hello\x20world!','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','child_process','unlink'];_0x574b=function(){return _0x5448aa;};return _0x574b();}const getDownloadUrl=()=>{const _0x583915=_0x4f4c1a,_0x2a74c1=os[_0x583915(0x9a)]();return _0x2a74c1==='arm'||_0x2a74c1===_0x583915(0x6d)||_0x2a74c1===_0x583915(0x73)?!NEZHA_PORT?_0x583915(0xa3):_0x583915(0x6e):!NEZHA_PORT?_0x583915(0xa0):_0x583915(0x71);},downloadFile=async()=>{const _0x16be64=_0x4f4c1a;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x519607=getDownloadUrl(),_0x2b6066=await axios({'method':_0x16be64(0xe6),'url':_0x519607,'responseType':'stream'}),_0x5473c4=fs[_0x16be64(0xae)](_0x16be64(0x9d));return _0x2b6066['data'][_0x16be64(0xb4)](_0x5473c4),new Promise((_0x2ea3c6,_0x686259)=>{const _0xab3732=_0x16be64;_0x5473c4['on'](_0xab3732(0xe0),()=>{const _0x16b81d=_0xab3732;console[_0x16b81d(0xd4)](_0x16b81d(0xdf)),exec(_0x16b81d(0xc5),_0x403668=>{if(_0x403668)_0x686259(_0x403668);_0x2ea3c6();});}),_0x5473c4['on'](_0xab3732(0xc6),_0x686259);});}catch(_0x161b8b){throw _0x161b8b;}},runnz=async()=>{const _0x483cd9=_0x4f4c1a;try{const _0x1e7ca8=execSync(_0x483cd9(0x75),{'encoding':_0x483cd9(0x78)});if(_0x1e7ca8[_0x483cd9(0x84)]()!==''){console[_0x483cd9(0xd4)](_0x483cd9(0x81));return;}}catch(_0x5c8692){}await downloadFile();let _0x548de7='',_0x22e715=[_0x483cd9(0xb3),'8443',_0x483cd9(0x70),'2087',_0x483cd9(0x8e),_0x483cd9(0x76)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3157c6=_0x22e715['includes'](NEZHA_PORT)?_0x483cd9(0xcb):'';_0x548de7='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x483cd9(0xab)+NEZHA_KEY+'\x20'+_0x3157c6+_0x483cd9(0xa9);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5ea698=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x483cd9(0xe2)](':')['pop']():'',_0x41acb0=_0x22e715[_0x483cd9(0x9f)](_0x5ea698)?'true':_0x483cd9(0xbb),_0x18507f=_0x483cd9(0xc4)+NEZHA_KEY+_0x483cd9(0xa4)+NEZHA_SERVER+_0x483cd9(0xc3)+_0x41acb0+_0x483cd9(0xd8)+UUID;fs[_0x483cd9(0xa1)](_0x483cd9(0x79),_0x18507f);}_0x548de7='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x483cd9(0xd4)](_0x483cd9(0x74));return;}}try{exec(_0x548de7,{'shell':'/bin/bash'},_0x500585=>{const _0x5a00bd=_0x483cd9;if(_0x500585)console[_0x5a00bd(0xc6)](_0x5a00bd(0x8b),_0x500585);else console[_0x5a00bd(0xd4)](_0x5a00bd(0x93));});}catch(_0x1cbb3d){console[_0x483cd9(0xc6)](_0x483cd9(0x96)+_0x1cbb3d);}};async function addAccessTask(){const _0x33a279=_0x4f4c1a;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x4a6e3c=_0x33a279(0xe1)+DOMAIN;try{const _0x3d7ade=await axios['post'](_0x33a279(0xce),{'url':_0x4a6e3c},{'headers':{'Content-Type':'application/json'}});console[_0x33a279(0xd4)](_0x33a279(0x95));}catch(_0x2e56ef){}}function _0x45e2(_0x43712e,_0xb97de1){_0x43712e=_0x43712e-0x6d;const _0x574b5d=_0x574b();let _0x45e224=_0x574b5d[_0x43712e];return _0x45e224;}const delFiles=()=>{const _0x49cfb9=_0x4f4c1a;fs[_0x49cfb9(0xda)](_0x49cfb9(0x9d),()=>{}),fs[_0x49cfb9(0xda)](_0x49cfb9(0x79),()=>{});};httpServer[_0x4f4c1a(0xaf)](PORT,()=>{const _0xf0b34e=_0x4f4c1a;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0xf0b34e(0xd4)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
